---
title: Singly Linked List
id: ff80f316-782a-459c-84ed-6964d330a2c9
date: 2023-Jul-02 21:45:47+08:00
description: indexï¼Ÿå¤ªå¤©çœŸäº†ï¼Œæˆ‘å¯æ˜¯ Linked List å•Šï¼
category: algorithm
---

å°±åƒæ˜¯ array ä¸€èˆ¬çš„è³‡æ–™çµæ§‹ï¼Œä½†æ²’æœ‰ indexï¼Œåªæœ‰è³‡æ–™çš„ä¸Šä¸‹ä¸²é€£é—œä¿‚ã€‚æ‰€ä»¥å¦‚æœæˆ‘å€‘æƒ³è¦æ‰¾ linked list è£¡é¢çš„ç¬¬äº”å€‹æ±è¥¿ï¼Œå°±è¦å…ˆå¾ç¬¬ä¸€å€‹é–‹å§‹ä¸€è·¯æ‰¾åˆ°ç¬¬äº”å€‹ã€‚

åœ¨ linked list è£¡é¢çš„æ¯ä¸€å€‹ element ç¨±ç‚º `node`ã€‚æ¯å€‹ node é™¤äº†å„²å­˜è‡ªå·±çš„è³‡æ–™ä¹‹å¤–ï¼Œé‚„æœƒæŒ‡å‘ä¸‹ä¸€å€‹ nodeã€‚

Linked list çš„ç¬¬ä¸€å€‹ node ç¨±ç‚º **head**ï¼Œæœ€å¾Œä¸€å€‹ç¨±ç‚º **tail**ï¼Œä¸¦è¨˜éŒ„ linked list çš„é•·åº¦ï¼Œæˆ‘å€‘å°±çŸ¥é“æ•´å€‹ linked list çš„æ¨£è²Œäº†ã€‚

Singly Linked List é¡§åæ€ç¾©æ˜¯å–®å‘çš„ï¼Œæ‰€ä»¥åªæœ‰ä¸Šä¸€å€‹ node æŒ‡å‘ä¸‹ä¸€å€‹ node çš„å–®å‘é—œä¿‚ï¼Œè€Œ Doubly Linked List å°±æœ‰é›™å‘çš„é—œä¿‚ã€‚

> æ¯”æ–¹èªªæœ‰å…©æ£Ÿè¶…é«˜çš„æ‘©å¤©å¤§æ¨“ï¼ŒArray å’Œ Linked Listã€‚Array æ˜¯æœ‰é›»æ¢¯çš„å¤§æ¨“ï¼ŒæŒ‰æŒ‰éˆ•å°±å¯ä»¥åˆ°é”ç‰¹å®šæ¨“å±¤ï¼›è€Œ Linked list åªæœ‰æ¨“æ¢¯å¯ä»¥çˆ¬ï¼Œéœ€è¦ä¸€æ­¥ä¸€è…³å°æ‰èƒ½æŠµé”è©²æ¨“å±¤ã€‚

## Arrays vs linked lists

### Arrays

- æœ‰ indexï¼Œä¸”å…·æœ‰é †åº
- æ’å…¥æˆ–åˆªé™¤æŸå€‹å€¼æ˜¯å¾ˆã€Œexpensiveã€çš„æ“ä½œï¼Œå› ç‚ºåœ¨æŸå€‹åœ°æ–¹æ’å…¥å€¼ï¼Œä»£è¡¨å¾Œé¢çš„ index éƒ½è¦è·Ÿè‘—è®Šå‹•

### Linked lists

- æ²’æœ‰ indexï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ head ä»£è¡¨ list çš„é–‹é ­ã€tail ä»£è¡¨ list çš„çµå°¾ï¼ˆäº‹å¯¦ä¸Š tail éå¿…è¦ï¼‰
- node å’Œ node ä¹‹é–“ç”¨ pointer ç›¸é€£ï¼Œå³å‰ä¸€å€‹ node æœƒæŒ‡å‘ä¸‹ä¸€å€‹ node
- å› ç‚ºæ²’æœ‰ indexï¼Œä»£è¡¨æ²’è¾¦æ³•éš¨æ©Ÿå­˜å–å€¼ã€‚å¦‚æœè¦æŸä¸€å€‹å€¼ï¼Œå¿…é ˆè¦éæ­·æ•´å€‹ list ç›´åˆ°åˆ°é”è©²å€¼
- æ’å…¥æˆ–åˆªé™¤æŸå€‹å€¼æ˜¯å¾ˆã€Œcheapã€çš„æ“ä½œï¼Œåœ¨æŸå€‹åœ°æ–¹æ’å…¥å€¼ä¸æœƒå½±éŸ¿ indexï¼ˆå› ç‚ºæ ¹æœ¬æ²’æœ‰ indexï¼Œåªæœ‰ä¸åœæŒ‡å‘ä¸‹ä¸€å€‹ nodeï¼‰

æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘ä¾†ç”¨ JavaScript å¯¦ä½œä¸€å€‹ linked list å§ï¼

## Singly Linked List çš„å„ç¨®æ“ä½œ

- [push](#push)
- [pop](#pop)
- [shift](#shift)
- [unshift](#unshift)
- [get](#get)
- [set](#set)
- [insert](#insert)
- [remove](#remove)
- [reverse](#reverse)

### Push

`Push()` æœƒå°‡ node åŠ åˆ°æ•´å€‹ list çš„æœ€å¾Œï¼Œæˆç‚ºæ–°çš„ tail

1. é€™å€‹ function æœƒæ¥æ”¶ä¸€å€‹ value
2. æ–°å¢ä¸€å€‹ nodeï¼Œå…¶å€¼ç‚ºå‚³å…¥ function çš„ value
3. å¦‚æœ list ä¸­æ²’æœ‰ headï¼Œé‚£éº¼å°‡é€™å€‹æ–°å¢çš„ node è¨­ç‚º head
4. å¦‚æœ list ä¸­å·²ç¶“æœ‰ headï¼Œé‚£éº¼å°‡ç›®å‰çš„ tail è£¡é¢çš„ next æŒ‡å‘æ–°å¢çš„é€™å€‹ nodeï¼Œä¸¦ä¸”å°‡ tail è¨­ç‚ºæ–°å¢çš„é€™å€‹ node
5. æœ€å¾Œï¼Œå°‡ list çš„é•·åº¦åŠ ä¸€

```js
push(val) {
	let newNode = new Node(val)
	// if this is the first node of list
	if (!this.head && !this.tail) {
		this.head = newNode
	} else {
		this.tail.next = newNode
	}

	this.tail = newNode
	this.length++
	// return the list
	return this
}
```

### Pop

`Pop()` æœƒå°‡ list ç›®å‰çš„ tail ç§»é™¤ï¼Œä¸¦å›å‚³ç§»é™¤çš„ node

é€™è½èµ·ä¾†å¥½åƒå¾ˆå®¹æ˜“ï¼Œä¸å°±æ˜¯æŠŠç›®å‰çš„ tail ç§»é™¤ï¼Œç„¶å¾ŒæŠŠå‰ä¸€å€‹ node æŒ‡å®šç‚ºæ–°çš„ tail å°±å¥½äº†å—ï¼Ÿ

æ˜¯...é€™æ¨£èªªæ²’éŒ¯å•¦ï¼Œä½†æ˜¯æˆ‘å€‘çš„ pointer æ˜¯æŒ‡å‘ã€Œä¸‹ä¸€å€‹ nodeã€ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œæˆ‘å€‘ç„¡æ³•é€é tail node ä¾†å–å¾—å‰ä¸€å€‹ nodeï¼Œåªèƒ½å¾é ­é–‹å§‹éæ­·æ•´å€‹ list ç›´åˆ°æœ€å¾Œä¸€å€‹ nodeï¼Œå†æŠŠå®ƒæŒ‡å®šç‚ºæ–°çš„ tail

```js
pop() {
  let popNode
  if (!this.head) return
  if (this.length === 1) {
    popNode = this.head
    this.head = null
    this.tail = null
  } else {
    // store the tail for later return
    popNode = this.tail
    let current = this.head
    let newTail = current

    while (current.next) {
      newTail = current
      // move current forward
      current = current.next
    }
    // set the tail to the second last item, and remove its next property
    this.tail = newTail
    this.tail.next = null
  }

  this.length--
  return popNode
}
```

### Shift

`shift()` æœƒå°‡ list çš„ç¬¬ä¸€å€‹ node ç§»é™¤

```js
shift() {
  if (!this.head) return
  let currentHead = this.head
  if (this.length === 1) {
    this.head = null
    this.tail = null
  } else {
    this.head = currentHead.next
  }

  this.length--
  return currentHead
}
```

### Unshift

`unshift()` æœƒæ–°å¢ä¸€å€‹ nodeï¼Œä½œç‚º list æ–°çš„ head

```js
unshift(val) {
  let newNode = new Node(val)
  if (!this.head) {
    this.head = newNode
    this.tail = newNode
  }

  newNode.next = this.head
  // update the head of list
  this.head = newNode
  this.length++
  return this
}
```

ä¸Šé¢çš„é€™æ®µ code çœ‹ä¼¼æ²’ä»€éº¼å¤§å•é¡Œï¼Œä½†åœ¨ list æ²’æœ‰å€¼çš„æ™‚å€™å‘¼å« `unshift()` é›–ç„¶æœƒæ–°å¢ä¸€å€‹ node ä¸¦ä½œç‚º head ä»¥åŠ tailï¼Œä½†åŒæ™‚é€™å€‹ node çš„ next ä¹ŸæœƒæŒ‡å‘è‡ªå·±ï¼Œè®“æˆ‘å€‘ä¾†èª¿æ•´ä¸€ä¸‹

```js
unshift(val) {
  let newNode = new Node(val)
  if (!this.head) {
    this.head = newNode
    this.tail = newNode
  } else {
    newNode.next = this.head
    // update the head of list
    this.head = newNode
  }

  this.length++
  return this
}
```

é€™æ¨£å°±æˆåŠŸè§£æ±ºä¸Šé¢æåˆ°çš„å•é¡Œäº†ï¼

### Get

`get()` å°±åƒ array å–æŸä¸€å€‹ index çš„å€¼ä¸€æ¨£ï¼Œæœƒå›å‚³è©²ä½ç½®çš„å€¼

```js
get(index) {
  if (index < 0 || index >= this.length) return null
  let counter = 0
  let currentNode = this.head
  while (counter < index) {
    counter++
    currentNode = currentNode.next
  }

  return currentNode
}
```

### Set

`set()` æœƒæ”¹è®Šç‰¹å®š index çš„å€¼ã€‚`set()` function æœƒæ¥æ”¶å…©å€‹åƒæ•¸ï¼Œåˆ†åˆ¥æ˜¯ index åŠè¦å¯«å…¥çš„å€¼ã€‚æˆ‘å€‘å¯ä»¥ä½¿ç”¨ä¸Šé¢å¯«å¥½çš„ `get()` ä¾†å¹«åŠ©æˆ‘å€‘æ‰¾åˆ°å€¼

```js
set(index, val) {
  let currentNode = this.get(index)

  if (!currentNode) {
    return false
  } else {
    currentNode.val = val
    return true
  }
}
```

### Insert

`insert()` åœ¨ç‰¹å®š index çš„ä½ç½®æ’å…¥æŸä¸€å€‹å€¼ã€‚

1. å¦‚æœ index å°æ–¼é›¶æˆ–å¤§æ–¼ list çš„é•·åº¦ï¼Œ`return false`
2. å¦‚æœ index ç­‰æ–¼ list çš„é•·åº¦ï¼Œä»£è¡¨è¦åœ¨æ•´å€‹ list çš„æœ€å¾ŒåŠ å…¥ä¸€å€‹ nodeï¼Œç­‰åŒæ–¼ `push` function
3. å¦‚æœ index ç­‰æ–¼é›¶ï¼Œä»£è¡¨è¦åœ¨æ•´å€‹ list çš„æœ€å‰é¢ã€ä¹Ÿå°±æ˜¯ headï¼ŒåŠ å…¥ä¸€å€‹ nodeï¼Œç­‰åŒæ–¼ `unshift` function
4. å¦‚æœä¸Šè¿°æ¢ä»¶éƒ½ä¸ç¬¦åˆï¼Œä»£è¡¨è¦æ’å…¥çš„å€¼åœ¨å…©å€‹ node ä¹‹é–“ã€‚ä½¿ç”¨ `get()` function å–å› `index-1` çš„ node
5. å°‡è©² node çš„ `next` ç”¨è®Šæ•¸å­˜èµ·ä¾†
6. ä»¥å‚³å…¥çš„ val å»ºç«‹æ–°çš„ node
7. å°‡ `get()` æ–¹æ³•å–å›çš„ node çš„ `next` è¨­ç‚ºæ–°çš„ node
8. å°‡æ’å…¥çš„ node æŒ‡å‘åŸå…ˆåœ¨è©²ä½ç½®çš„ node
9. list length++
10. return `true`

```js
insert(index, val) {
  // if index less than zero or greater than the length of list, return false
  if (index < 0 || index > this.length) return false

  // if index equal to the length of list, which means to insert node at the end of list, which is push
  if (index === this.length) return !!this.push(val)

  // if index equal to zero, which means to insert node at the start of list, which is unshift
  if (index === 0) return !!this.unshift(val)

  // get the item before our index
  let currentNode = this.get(index - 1)
  let temp = currentNode.next
  let newNode = new Node(val)
  currentNode.next = newNode
  newNode.next = temp
  this.length++
  return true
}
```

### Remove

ç§»é™¤ä½æ–¼è©² index ä¸Šçš„ node

```js
remove(index) {
  if (index < 0 || index > this.length) return
  if (index === 0) this.shift()
  if (index === this.length - 1) this.pop()

  let prev = this.get(index - 1)
  let removeNode = prev.next
  // point the previous node to next next
  prev.next = removeNode.next
  this.length--
  return removeNode
}
```

### Reverse

åè½‰æ•´å€‹ linked listï¼Œå‰ææ˜¯è¦åœ¨åŸåœ°å®Œæˆï¼ˆin-placeï¼‰åè½‰ï¼Œä¸èƒ½åšä¸€å€‹ copy ç„¶å¾Œå›å‚³ã€‚

é¦–å…ˆå…ˆå°‡ head åŠ tail å°èª¿ï¼Œç”±æ–¼åè½‰éå¾Œ head å’Œ tail æœƒäº’æ›ï¼Œè€Œ head çš„å‰ä¸€å€‹ node ç‚º nullï¼Œå› æ­¤å°‡ `prev` è®Šæ•¸çš„åˆå§‹å€¼è¨­ç‚º `null`ã€‚

ç”¨ `node` è®Šæ•¸å„²å­˜æœ€ä¸€é–‹å§‹çš„ headï¼Œ`prev` è®Šæ•¸å„²å­˜åè½‰å¾Œ node æ‡‰è©²è¦æŒ‡å‘çš„æ–° nodeï¼Œ`next` è®Šæ•¸å°‡åŸå…ˆ node çš„ `next` ä¿å­˜ï¼Œé¿å…åœ¨äº¤æ›çš„æ™‚å€™è¢«è¦†è“‹ã€‚

```js
reverse() {
  // swap head and tail
  let node = this.head
  this.head = this.tail
  this.tail = node
  
  // å°‡ prev åˆå§‹è¨­ç‚º nullï¼Œå› ç‚º tail (head çš„åè½‰) æ‡‰è©²è¦æŒ‡å‘ null
  let prev = null
  let next

  for (let i = 0; i < this.length; i++) {
    // æŠŠç•¶å‰ node çš„ next node ä»¥ next è®Šæ•¸å­˜èµ·ä¾†
    next = node.next
    // æŠŠç•¶å‰ node æŒ‡å‘å‰ä¸€å€‹ nodeï¼Œä¹Ÿå°±æ˜¯ prev è®Šæ•¸å­˜çš„ node
    node.next = prev
    // æ­¤æ™‚çš„ node è®Šæˆä¸‹ä¸€å€‹ node æ‡‰è©²è¦æŒ‡å‘çš„å‰ä¸€å€‹ nodeï¼Œå› æ­¤æŠŠ prev çš„å€¼æ”¹ç‚ºç•¶å‰ node
    prev = node
    // ç¹¼çºŒè™•ç†ä¸‹ä¸€å€‹ nodeï¼Œä¹Ÿå°±æ˜¯æœ€ä¸€é–‹å§‹å„²å­˜çš„ next
    node = next
  }

  return this
}
```

`reverse` çš„ code çœ‹èµ·ä¾†å¾ˆç°¡å–®ï¼Œä½†æƒ³çš„éç¨‹æŒºç‡’è…¦çš„ ğŸ« 

## Whole singly linked list

æŠŠä¸Šé¢æ‰€æœ‰çš„æ–¹æ³•ç¶œåˆèµ·ä¾†ï¼Œå°±æ˜¯å®Œæ•´çš„ singly linked lists äº† ğŸ‰ï¼

```js
class Node {
  constructor(val) {
    this.val = val
    this.next = null
  }
}

class SinglyLinkedList {
  constructor() {
    this.head = null
    this.tail = null
    this.length = 0
  }

  push(val) {
    let newNode = new Node(val)
    // if this is the first node of list
    if (!this.head && !this.tail) {
      this.head = newNode
    } else {
      this.tail.next = newNode
    }

    this.tail = newNode
    this.length++
    // return the list
    return this
  }

  pop() {
    let popNode
    if (!this.head) return
    if (this.length === 1) {
      popNode = this.head
      this.head = null
      this.tail = null
    } else {
      // store the tail for later return
      popNode = this.tail
      let current = this.head
      let newTail = current

      while (current.next) {
        newTail = current
        // move current forward
        current = current.next
      }
      // set the tail to the second last item, and remove its next property
      this.tail = newTail
      this.tail.next = null
    }

    this.length--
    return popNode
  }

  shift() {
    if (!this.head) return
    let currentHead = this.head
    if (this.length === 1) {
      this.head = null
      this.tail = null
    } else {
      this.head = currentHead.next
    }

    this.length--
    return currentHead
  }

  unshift(val) {
    let newNode = new Node(val)
    if (!this.head) {
      this.head = newNode
      this.tail = newNode
    }

    newNode.next = this.head
    // update the head of list
    this.head = newNode
    this.length++
    return this
  }

  get(index) {
    if (index < 0 || index >= this.length) return null
    let counter = 0
    let currentNode = this.head
    while (counter < index) {
      counter++
      currentNode = currentNode.next
    }

    return currentNode
  }

  set(index, val) {
    let currentNode = this.get(index)

    if (!currentNode) {
      return false
    } else {
      currentNode.val = val
      return true
    }
  }

  insert(index, val) {
    // if index less than zero or greater than the length of list, return false
    if (index < 0 || index > this.length) return false

    // if index equal to the length of list, which means to insert node at the end of list, which is push
    if (index === this.length) return !!this.push(val)

    // if index equal to zero, which means to insert node at the start of list, which is unshift
    if (index === 0) return !!this.unshift(val)

    // get the item before our index
    let currentNode = this.get(index - 1)
    let temp = currentNode.next
    let newNode = new Node(val)
    currentNode.next = newNode
    newNode.next = temp
    this.length++
    return true
  }

  remove(index) {
    if (index < 0 || index > this.length) return
    if (index === 0) this.shift()
    if (index === this.length - 1) this.pop()

    let prev = this.get(index - 1)
    let removeNode = prev.next
    // point the previous node to next next
    prev.next = removeNode.next
    this.length--
    return removeNode
  }

  reverse() {
    // swap head and tail
    let node = this.head
    this.head = this.tail
    this.tail = node
    
    // å°‡ prev åˆå§‹è¨­ç‚º nullï¼Œå› ç‚º tail (head çš„åè½‰) æ‡‰è©²è¦æŒ‡å‘ null
    let prev = null
    let next

    for (let i = 0; i < this.length; i++) {
      // æŠŠç•¶å‰ node çš„ next node ä»¥ next è®Šæ•¸å­˜èµ·ä¾†
      next = node.next
      // æŠŠç•¶å‰ node æŒ‡å‘å‰ä¸€å€‹ nodeï¼Œä¹Ÿå°±æ˜¯ prev è®Šæ•¸å­˜çš„ node
      node.next = prev
      // æ­¤æ™‚çš„ node è®Šæˆä¸‹ä¸€å€‹ node æ‡‰è©²è¦æŒ‡å‘çš„å‰ä¸€å€‹ nodeï¼Œå› æ­¤æŠŠ prev çš„å€¼æ”¹ç‚ºç•¶å‰ node
      prev = node
      // ç¹¼çºŒè™•ç†ä¸‹ä¸€å€‹ nodeï¼Œä¹Ÿå°±æ˜¯æœ€ä¸€é–‹å§‹å„²å­˜çš„ next
      node = next
    }

    return this
  }
}
```

## Singly Linked Lists çš„æ™‚é–“è¤‡é›œåº¦

- æ’å…¥ï¼ˆInsertionï¼‰ï¼šsingly linked list åœ¨æ’å…¥æŸå€‹å€¼ä¹‹å¾Œä¸æœƒå½±éŸ¿å…¶ä»–å€¼çš„ indexï¼Œæ‰€ä»¥æ™‚é–“è¤‡é›œåº¦ç‚º $O(1)$ï¼Œè€Œå° array é€²è¡Œå€¼çš„æ’å…¥ç‚º $O(n)$ã€‚
- ç§»é™¤ï¼ˆRemovalï¼‰ï¼šæŠŠæŸå€‹å…ƒç´ ç§»é™¤ singly linked listã€‚å¦‚æœç§»é™¤çš„å…ƒç´ æ˜¯ headï¼Œé‚£éº¼æ™‚é–“è¤‡é›œåº¦ç‚º $O(1)$ï¼Œå› ç‚ºæˆ‘å€‘åªéœ€è¦æŠŠèˆŠçš„ head æŒ‡å‘ nullï¼Œä¸¦æŠŠ `head.next` è¨­ç‚ºæ–°çš„ head å³å¯ï¼›å¦‚æœç§»é™¤çš„å…ƒç´ æ˜¯ tailï¼Œé‚£å°±å¿…é ˆéæ­·æ•´å€‹ linked list ç›´åˆ° tail çš„å‰ä¸€å€‹ nodeï¼Œä¸¦æŠŠå®ƒæŒ‡å®šç‚ºæ–°çš„ tailï¼Œæ­¤æ™‚çš„æ™‚é–“è¤‡é›œåº¦ç‚º $O(n)$ã€‚
- å°‹æ‰¾ï¼ˆSearchingï¼‰åŠå–å¾—ï¼ˆAccesï¼‰ï¼šè¦å°‹æ‰¾æŸå€‹ç‰¹å®šçš„ nodeï¼Œå¿…é ˆè¦éæ­·æ•´å€‹ listï¼Œå› æ­¤æ™‚é–“è¤‡é›œåº¦ç‚º $O(n)$ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œarray å–å¾—æŸå€‹ç‰¹å®š index å€¼çš„æ™‚é–“è¤‡é›œåº¦ç‚º $O(1)$ã€‚

## ç¸½çµ

Singly Linked Lists æ²’æœ‰ indexï¼Œæ‰€ä»¥å’Œ array ç›¸æ¯”ä¹‹ä¸‹ï¼Œå–å¾—æŸå€‹ index ä¹‹å€¼çš„æ™‚é–“å°±éœè‰²è¨±å¤šï¼Œä½†ä¹Ÿå› ç‚ºå¦‚æ­¤ï¼Œlinked lists åœ¨åŸ·è¡Œæ’å…¥å‹•ä½œæ™‚å°±æ¯” array å¿«ä¸Šä¸å°‘ã€‚
